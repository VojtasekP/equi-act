program: src/train.py
method: grid
project: mnist_rot
metric:
  name: val_loss
  goal: minimize

parameters:
  project:
    value: "mnist_rot"
  dataset:
    values: ["mnist_rot"]
  activation_type:
    values:
      # - gated_sigmoid
      # - gated_shared_sigmoid
      # - norm_relu
      # - norm_squash
      # - fourier_relu_16
      # - fourier_elu_16
      # - normbn_relu
      # - normbn_elu
      # - normbn_sigmoid
      # - normbnvec_relu
      # - normbnvec_elu
      # - normbnvec_sigmoid
      # - fourierbn_elu_16
      # - fourierbn_relu_64
      - fourierbn_relu_128
      - fourier_relu_128
      # - fourierbn_relu_32
      # - fourierbn_relu_16
    
  bn:
    values: ["Normbn"]
  seed:
    values: [0, 1, 2, 3, 4]
  max_rot_order:
    value: 3
  flip:
    values: [false]

  aug:
    values: [true]
  normalize:
    value: true
  residual:
    value: false
  blocks:
    value:
      - [16, 7, 3]
      - [24, 5, 2]
      - [32, 5, 2]
      - [32, 5, 2]
      - [48, 5, 2]
      - [64, 5, 2]
  conv_sigma:
    values: [0.6]
  pool_after_every_n_blocks:
    value: 2
  pool_size:
    value: 2
  pool_sigma:
    value: 0.66
  invar_type:
    values: ['norm']
  pool_type:
    values: ['max']
  invariant_channels:
    # value: 96
    value: 64
  invar_error_logging:
    value: false
  invar_check_every_n_epochs:
    value: 3
  invar_chunk_size:
    value: 1
  num_of_batches_to_use_for_invar_logging:
    value: 5
  num_of_angles:
    value: 8

  lr:
    value: 0.001
  weight_decay:
    value: 0
  burin_in_period:
    value: 10
  batch_size:
    value: 64
  epochs:
    value: 30
  patience:
    value: 60
  img_size:
    value: 29

  model_export_dir:
    value: "saved_models/"
  model_export_subdir:
    value: "mnist_rot_final/"
    
